<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>healthcreek-ui documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">healthcreek-ui documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>ObservationService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/services/observation.service.ts</code>
        </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#categorizedObservations">categorizedObservations</a>
                            </li>
                            <li>
                                <a href="#count">count</a>
                            </li>
                            <li>
                                <a href="#filterSet">filterSet</a>
                            </li>
                            <li>
                                <a href="#groupMap">groupMap</a>
                            </li>
                            <li>
                                <a href="#observations">observations</a>
                            </li>
                            <li>
                                <a href="#selected">selected</a>
                            </li>
                            <li>
                                <a href="#uniqueObservations">uniqueObservations</a>
                            </li>
                            <li>
                                <a href="#uniqueObservationsLoadFinished">uniqueObservationsLoadFinished</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#extractNewObservations">extractNewObservations</a>
                            </li>
                            <li>
                                <a href="#getCheckedObservations">getCheckedObservations</a>
                            </li>
                            <li>
                                <a href="#getGrouping">getGrouping</a>
                            </li>
                            <li>
                                <a href="#getScratchPadObservations">getScratchPadObservations</a>
                            </li>
                            <li>
                                <a href="#handleObservationBundle">handleObservationBundle</a>
                            </li>
                            <li>
                                <a href="#loadObservationsPage">loadObservationsPage</a>
                            </li>
                            <li>
                                <a href="#onLoadComplete">onLoadComplete</a>
                            </li>
                            <li>
                                <a href="#populateCategories">populateCategories</a>
                            </li>
                            <li>
                                <a href="#scaleDates">scaleDates</a>
                            </li>
                            <li>
                                <a href="#showDefault">showDefault</a>
                            </li>
                            <li>
                                <a href="#showScratchPad">showScratchPad</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(fhirService: <a href="../injectables/FhirService.html">FhirService</a>, http: <a href="../classes/Client.html">HttpClient</a>, scratchPadService: <a href="../injectables/ScratchPadService.html">ScratchPadService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="22" class="link-to-prism">src/app/services/observation.service.ts:22</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>fhirService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/FhirService.html" target="_self" >FhirService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>http</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/Client.html" target="_self" >HttpClient</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>scratchPadService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ScratchPadService.html" target="_self" >ScratchPadService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="extractNewObservations"></a>
                    <span class="name">
                        <b>
                            extractNewObservations
                        </b>
                        <a href="#extractNewObservations"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>extractNewObservations(observations: <a href="../classes/Observation.html">Array<Observation></a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="190"
                            class="link-to-prism">src/app/services/observation.service.ts:190</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>observations</td>
                                    <td>
                                                <code><a href="../classes/Observation.html" target="_self" >Array&lt;Observation&gt;</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getCheckedObservations"></a>
                    <span class="name">
                        <b>
                            getCheckedObservations
                        </b>
                        <a href="#getCheckedObservations"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getCheckedObservations()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="175"
                            class="link-to-prism">src/app/services/observation.service.ts:175</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getGrouping"></a>
                    <span class="name">
                        <b>
                            getGrouping
                        </b>
                        <a href="#getGrouping"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getGrouping(code: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="206"
                            class="link-to-prism">src/app/services/observation.service.ts:206</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Given a certain observation ID, returns the position mapping of that
 ID contained within the groupMap</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>code</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getScratchPadObservations"></a>
                    <span class="name">
                        <b>
                            getScratchPadObservations
                        </b>
                        <a href="#getScratchPadObservations"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getScratchPadObservations()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="255"
                            class="link-to-prism">src/app/services/observation.service.ts:255</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="handleObservationBundle"></a>
                    <span class="name">
                        <b>
                            handleObservationBundle
                        </b>
                        <a href="#handleObservationBundle"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>handleObservationBundle(bundle: <a href="../classes/Bundle.html">Bundle</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="139"
                            class="link-to-prism">src/app/services/observation.service.ts:139</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>bundle</td>
                                    <td>
                                                <code><a href="../classes/Bundle.html" target="_self" >Bundle</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="loadObservationsPage"></a>
                    <span class="name">
                        <b>
                            loadObservationsPage
                        </b>
                        <a href="#loadObservationsPage"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>loadObservationsPage(url: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="132"
                            class="link-to-prism">src/app/services/observation.service.ts:132</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>url</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="onLoadComplete"></a>
                    <span class="name">
                        <b>
                            onLoadComplete
                        </b>
                        <a href="#onLoadComplete"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>onLoadComplete()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="157"
                            class="link-to-prism">src/app/services/observation.service.ts:157</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="populateCategories"></a>
                    <span class="name">
                        <b>
                            populateCategories
                        </b>
                        <a href="#populateCategories"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>populateCategories(categories: Array<literal type>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="217"
                            class="link-to-prism">src/app/services/observation.service.ts:217</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>categories</td>
                                    <td>
                                            <code>Array&lt;literal type&gt;</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="scaleDates"></a>
                    <span class="name">
                        <b>
                            scaleDates
                        </b>
                        <a href="#scaleDates"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>scaleDates()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="179"
                            class="link-to-prism">src/app/services/observation.service.ts:179</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="showDefault"></a>
                    <span class="name">
                        <b>
                            showDefault
                        </b>
                        <a href="#showDefault"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>showDefault()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="260"
                            class="link-to-prism">src/app/services/observation.service.ts:260</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="showScratchPad"></a>
                    <span class="name">
                        <b>
                            showScratchPad
                        </b>
                        <a href="#showScratchPad"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>showScratchPad()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="264"
                            class="link-to-prism">src/app/services/observation.service.ts:264</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="categorizedObservations"></a>
                        <span class="name">
                            <b>
                            categorizedObservations</b>
                            <a href="#categorizedObservations"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="15" class="link-to-prism">src/app/services/observation.service.ts:15</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="count"></a>
                        <span class="name">
                            <b>
                            count</b>
                            <a href="#count"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>0</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="17" class="link-to-prism">src/app/services/observation.service.ts:17</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="filterSet"></a>
                        <span class="name">
                            <b>
                            filterSet</b>
                            <a href="#filterSet"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>new Set&lt;string&gt;()</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="22" class="link-to-prism">src/app/services/observation.service.ts:22</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="groupMap"></a>
                        <span class="name">
                            <b>
                            groupMap</b>
                            <a href="#groupMap"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>literal type</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="16" class="link-to-prism">src/app/services/observation.service.ts:16</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="observations"></a>
                        <span class="name">
                            <b>
                            observations</b>
                            <a href="#observations"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../classes/Observation.html" target="_self" >Array&lt;Observation&gt;</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>[]</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="18" class="link-to-prism">src/app/services/observation.service.ts:18</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="selected"></a>
                        <span class="name">
                            <b>
                            selected</b>
                            <a href="#selected"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../classes/Observation.html" target="_self" >Array&lt;Observation&gt;</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>[]</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="19" class="link-to-prism">src/app/services/observation.service.ts:19</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="uniqueObservations"></a>
                        <span class="name">
                            <b>
                            uniqueObservations</b>
                            <a href="#uniqueObservations"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../classes/Observation.html" target="_self" >Array&lt;Observation&gt;</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>[]</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="14" class="link-to-prism">src/app/services/observation.service.ts:14</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="uniqueObservationsLoadFinished"></a>
                        <span class="name">
                            <b>
                            uniqueObservationsLoadFinished</b>
                            <a href="#uniqueObservationsLoadFinished"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>false</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="20" class="link-to-prism">src/app/services/observation.service.ts:20</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable } from &#x27;@angular/core&#x27;;
import { HttpClient } from &#x27;@angular/common/http&#x27;;

import * as moment from &#x27;moment&#x27;;

import { FhirService } from &#x27;./fhir.service&#x27;;
import { ScratchPadService } from &#x27;../services/scratchPad.service&#x27;;

import { Observation } from &#x27;../models/observation.model&#x27;;
import { Bundle } from &#x27;../models/bundle.model&#x27;;

@Injectable()
export class ObservationService {
  uniqueObservations: Array&lt;Observation&gt; &#x3D; [];
  categorizedObservations: any;
  groupMap: { [x: string]: Array&lt;String&gt; };
  count &#x3D; 0;
  observations: Array&lt;Observation&gt; &#x3D; [];
  selected: Array&lt;Observation&gt; &#x3D; [];
  uniqueObservationsLoadFinished &#x3D; false;

  filterSet &#x3D; new Set&lt;string&gt;();

  constructor(
    private fhirService: FhirService,
    private http: HttpClient,
    private scratchPadService: ScratchPadService
  ) {
    // these are the codes of the observations; 
    // groupList is used to categorize where in categorizedObservations this is stored
    this.groupMap &#x3D; {
      &quot;1-1&quot;: [&quot;8302-2&quot;, &quot;3141-9&quot;, &quot;2710-2&quot;],
      &quot;1-2&quot;: [],
      &quot;1-3&quot;: [],
      &quot;1-4&quot;: [&quot;39156-5&quot;, &quot;8310-5&quot;],
      &quot;1-5&quot;: [],
      &quot;2-1&quot;: [&quot;2571-8&quot;],
      &quot;2-2-1&quot;: [&quot;789-8&quot;, &quot;3094-0&quot;, &quot;72166-2&quot;],
      &quot;2-2-2&quot;: [],
      &quot;2-2-3&quot;: [&quot;2823-3&quot;]
    };

    // categories of the observations; found using groupList
    this.categorizedObservations &#x3D; {
      &quot;categories&quot;: [
        {
          &quot;display&quot;: &quot;Vitals&quot;,
          &quot;id&quot;: &quot;1&quot;,
          &quot;count&quot;: 0,
          &quot;child&quot;: [
            {
              &quot;display&quot;: &quot;Weight&quot;,
              &quot;data&quot;: [],
              &quot;count&quot;: 0,
              &quot;id&quot;: &quot;1-1&quot;
            },
            {
              &quot;display&quot;: &quot;Blood Pressure&quot;,
              &quot;data&quot;: [],
              &quot;count&quot;: 0,
              &quot;id&quot;: &quot;1-2&quot;
            },
            {
              &quot;display&quot;: &quot;Heart Rate&quot;,
              &quot;data&quot;: [],
              &quot;count&quot;: 0,
              &quot;id&quot;: &quot;1-3&quot;
            },
            {
              &quot;display&quot;: &quot;Respiration Rate&quot;,
              &quot;data&quot;: [],
              &quot;count&quot;: 0,
              &quot;id&quot;: &quot;1-4&quot;
            },
            {
              &quot;display&quot;: &quot;Temperature&quot;,
              &quot;data&quot;: [],
              &quot;count&quot;: 0,
              &quot;id&quot;: &quot;1-5&quot;
            }
          ]
        },

        {
          &quot;display&quot;: &quot;Patient History / Review of Systems&quot;,
          &quot;id&quot;: &quot;2&quot;,
          &quot;count&quot;: 0,
          &quot;child&quot;: [
            {
              &quot;display&quot;: &quot;Constitutional Symptoms&quot;,
              &quot;data&quot;: [],
              &quot;count&quot;: 0,
              &quot;id&quot;: &quot;2-1&quot;
            },
            {
              &quot;display&quot;: &quot;Body Systems&quot;,
              &quot;count&quot;: 0,
              &quot;id&quot;: &quot;2-2&quot;,
              &quot;child&quot;: [
                {
                  &quot;display&quot;: &quot;Eyes&quot;,
                  &quot;data&quot;: [],
                  &quot;count&quot;: 0,
                  &quot;id&quot;: &quot;2-2-1&quot;
                },
                {
                  &quot;display&quot;: &quot;Ears, Nose, Mouth and Throat (ENT)&quot;,
                  &quot;data&quot;: [],
                  &quot;count&quot;: 0,
                  &quot;id&quot;: &quot;2-2-2&quot;
                },
                {
                  &quot;display&quot;: &quot;Cardiovascular&quot;,
                  &quot;data&quot;: [],
                  &quot;count&quot;: 0,
                  &quot;id&quot;: &quot;2-2-3&quot;
                }
              ]
            }
          ]
        },
        {
          &quot;display&quot;: &quot;Other&quot;,
          &quot;id&quot;: &quot;3&quot;,
          &quot;count&quot;: 0,
          &quot;data&quot;: []
        }
      ]
    };
  }

  loadObservationsPage(url: string): void {
    this.http.get&lt;Bundle&gt;(url, this.fhirService.getRequestOptions())
      .subscribe((bundle) &#x3D;&gt; {
        this.handleObservationBundle(bundle);
      });
  }

  handleObservationBundle(bundle: Bundle): void {
    if (bundle) {
      let nextObservations &#x3D; &lt;Array&lt;Observation&gt;&gt;bundle.entry.map(e &#x3D;&gt; e.resource);
      this.observations &#x3D; this.observations.concat(nextObservations);
      this.extractNewObservations(nextObservations);

      let nextLink &#x3D; bundle.link.find(link &#x3D;&gt; link.relation &#x3D;&#x3D; &#x27;next&#x27;);
      if (nextLink) {
        this.loadObservationsPage(nextLink.url);
      } else {
        this.onLoadComplete();
      }
    } else {
      console.log(&quot;No observations for patient.&quot;);
      this.observations &#x3D; new Array&lt;Observation&gt;();
    }
  }

  onLoadComplete() {
    this.observations &#x3D; this.observations.reverse();
    console.log(&quot;Loaded &quot; + this.uniqueObservations.length + &quot; observations.&quot;);
    this.uniqueObservationsLoadFinished &#x3D; true;

    this.observations.sort((n1, n2) &#x3D;&gt; {
      return n1.effectiveDateTime &lt; n2.effectiveDateTime ? 1 : -1;
    })

    this.scaleDates();

    this.populateCategories(this.categorizedObservations.categories);
    // The condensed observations should be the final set of data -- add it to the scratchpadservice
    this.scratchPadService.initObservations(this.uniqueObservations);

    //this.observationReturned.emit(this.observationService.categorizedObservations);
  }

  getCheckedObservations() {
    return this.observations.filter(o &#x3D;&gt; this.scratchPadService.checkedMapObservations.get(o));
  }

  scaleDates(): void {
    let RECENCY_MULTIPLIER &#x3D; 0.80;
    let timeSinceObservation &#x3D; new Date().getTime() - new Date(this.observations[0].effectiveDateTime).getTime();
    let scaledTimeSinceObservation &#x3D; Math.floor(RECENCY_MULTIPLIER * timeSinceObservation);

    for (let ob of this.observations) {
      let relativeDateTime &#x3D; new Date(ob.effectiveDateTime).getTime() + scaledTimeSinceObservation;
      ob.relativeDateTime &#x3D; moment(relativeDateTime).toISOString();
    }
  }

  extractNewObservations(observations: Array&lt;Observation&gt;): void {
    for (let observation of observations) {
      let code: string &#x3D; observation[&#x27;code&#x27;][&#x27;coding&#x27;][0][&#x27;code&#x27;];
      if (!this.filterSet.has(code)) {
        observation.grouping &#x3D; this.getGrouping(code);
        this.uniqueObservations.push(observation);

        this.filterSet.add(code);
      }
    }
  }

  /**
  * Given a certain observation ID, returns the position mapping of that
   * ID contained within the groupMap
   */
  getGrouping(code: string): string {
    for (let x in this.groupMap) {
      if (this.groupMap[x].indexOf(code) !&#x3D;&#x3D; -1) {
        return x;
      }
    }

    let OTHER_GROUPING &#x3D; &#x27;3&#x27;;
    return OTHER_GROUPING;
  }

  populateCategories(categories: Array&lt;{ [x: string]: any }&gt;): number {
    let totalCount &#x3D; 0;
    for (let i &#x3D; 0; i &lt; categories.length; i++) {
      let category &#x3D; categories[i];
      if (category.hasOwnProperty(&#x27;data&#x27;)) {
        //Depending on what grouping was assigned to a observation, add it to the relevant category
        for (let obs of this.uniqueObservations) {
          if (obs.grouping &#x3D;&#x3D; category[&#x27;id&#x27;]) {
            // This is a crappy solution, want sometime more robust in the future - Austin Michne
            let measurement &#x3D; { &quot;name&quot;: Observation.getText(obs), &quot;code&quot;: obs[&#x27;code&#x27;][&#x27;coding&#x27;][0][&#x27;code&#x27;], &quot;date&quot;: obs.effectiveDateTime };
            if (obs.hasOwnProperty(&quot;valueQuantity&quot;)) {
              measurement[&quot;value&quot;] &#x3D; obs[&quot;valueQuantity&quot;][&quot;value&quot;];
            }

            category[&#x27;data&#x27;].push(measurement);
          }
        }
        category[&#x27;count&#x27;] &#x3D; category[&#x27;data&#x27;].length;
        totalCount +&#x3D; category[&#x27;count&#x27;];
        if (category[&#x27;count&#x27;] &#x3D;&#x3D; 0) {
          categories.splice(i--, 1);
        }
      }
      else if (category.hasOwnProperty(&#x27;child&#x27;)) {
        if (category[&#x27;child&#x27;].length &#x3D;&#x3D; 0) {
          categories.splice(i--, 1);
        }
        else {
          category[&#x27;count&#x27;] &#x3D; this.populateCategories(category[&#x27;child&#x27;]);
          totalCount +&#x3D; category[&#x27;count&#x27;];
        }
      }
    }
    return totalCount;
  }

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; SCRATCH PAD FUNCTIONALITY &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  getScratchPadObservations() {
    return this.scratchPadService.getObservations();
  }

  // OVERRIDDEN FROM BASECOLUMN:
  showDefault() {

  }

  showScratchPad() {
    console.log(this.getScratchPadObservations());
  }
}</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'ObservationService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
