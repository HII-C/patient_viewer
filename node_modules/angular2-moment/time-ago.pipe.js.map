{"version":3,"file":"time-ago.pipe.js","sourceRoot":"","sources":["time-ago.pipe.ts"],"names":[],"mappings":"AAAA,6DAA6D;;AAE7D,qBAA0E,eAAe,CAAC,CAAA;AAC1F,IAAY,MAAM,WAAM,QAAQ,CAAC,CAAA;AAEjC,4FAA4F;AAC5F,IAAM,iBAAiB,GAAyC,MAAO,CAAC,OAAO,IAAI,MAAM,CAAC;AAG1F;IAGE,qBAAoB,MAAyB,EAAU,OAAe;QAAlD,WAAM,GAAN,MAAM,CAAmB;QAAU,YAAO,GAAP,OAAO,CAAQ;IACtE,CAAC;IAED,+BAAS,GAAT,UAAU,KAA2B,EAAE,UAAoB;QAA3D,iBAYC;QAXC,IAAM,cAAc,GAAG,iBAAiB,CAAC,KAAK,CAAC,CAAC;QAChD,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAM,YAAY,GAAG,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,GAAG,IAAI,CAAC;QACxE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC;YAClD,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,WAAW,CAAC,CAAC,CAAC;gBAClC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC;oBACvB,KAAI,CAAC,OAAO,CAAC,GAAG,CAAC,cAAM,OAAA,KAAI,CAAC,MAAM,CAAC,YAAY,EAAE,EAA1B,CAA0B,CAAC,CAAC;gBACrD,CAAC,EAAE,YAAY,CAAC,CAAC;YACnB,CAAC;QACH,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,iBAAiB,EAAE,EAAE,UAAU,CAAC,CAAC;IACxE,CAAC;IAED,iCAAW,GAAX;QACE,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAED,kCAAY,GAAZ;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;YACvB,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YACxC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAC5B,CAAC;IACH,CAAC;IAED,4CAAsB,GAAtB,UAAuB,cAA6B;QAClD,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,iBAAiB,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC,CAAC;QAC5E,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YACf,MAAM,CAAC,CAAC,CAAC;QACX,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC,CAAC;YACvB,MAAM,CAAC,EAAE,CAAC;QACZ,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC;YACxB,MAAM,CAAC,GAAG,CAAC;QACb,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,CAAC,IAAI,CAAC;QACd,CAAC;IACH,CAAC;IACI,sBAAU,GAA0B;QAC3C,EAAE,IAAI,EAAE,WAAI,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,KAAK,EAAE,EAAG,EAAE;KAC3D,CAAC;IACF,kBAAkB;IACX,0BAAc,GAA6D;QAClF,EAAC,IAAI,EAAE,wBAAiB,GAAG;QAC3B,EAAC,IAAI,EAAE,aAAM,GAAG;KACf,CAAC;IACF,kBAAC;AAAD,CAAC,AAnDD,IAmDC;AAnDY,mBAAW,cAmDvB,CAAA","sourcesContent":["/* angular2-moment (c) 2015, 2016 Uri Shaked / MIT Licence */\n\nimport { Pipe, ChangeDetectorRef, PipeTransform, OnDestroy, NgZone } from '@angular/core';\nimport * as moment from 'moment';\n\n// under systemjs, moment is actually exported as the default export, so we account for that\nconst momentConstructor: (value?: any) => moment.Moment = (<any>moment).default || moment;\n\n\nexport class TimeAgoPipe implements PipeTransform, OnDestroy {\n  private _currentTimer: number;\n\n  constructor(private _cdRef: ChangeDetectorRef, private _ngZone: NgZone) {\n  }\n\n  transform(value: Date | moment.Moment, omitSuffix?: boolean): string {\n    const momentInstance = momentConstructor(value);\n    this._removeTimer();\n    const timeToUpdate = this._getSecondsUntilUpdate(momentInstance) * 1000;\n    this._currentTimer = this._ngZone.runOutsideAngular(() => {\n      if (typeof window !== 'undefined') {\n        return window.setTimeout(() => {\n          this._ngZone.run(() => this._cdRef.markForCheck());\n        }, timeToUpdate);\n      }\n    });\n    return momentConstructor(value).from(momentConstructor(), omitSuffix);\n  }\n\n  ngOnDestroy(): void {\n    this._removeTimer();\n  }\n\n  _removeTimer() {\n    if (this._currentTimer) {\n      window.clearTimeout(this._currentTimer);\n      this._currentTimer = null;\n    }\n  }\n\n  _getSecondsUntilUpdate(momentInstance: moment.Moment) {\n    const howOld = Math.abs(momentConstructor().diff(momentInstance, 'minute'));\n    if (howOld < 1) {\n      return 1;\n    } else if (howOld < 60) {\n      return 30;\n    } else if (howOld < 180) {\n      return 300;\n    } else {\n      return 3600;\n    }\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Pipe, args: [{ name: 'amTimeAgo', pure: false }, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n{type: ChangeDetectorRef, },\n{type: NgZone, },\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}